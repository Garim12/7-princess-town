<!DOCTYPE html>
<html lang="ko-KR" xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="shortcut icon" href="/img/tomato_logo.png">
    <title>우리 동네 커뮤니티 토마토</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--    구글 폰트      -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gugi&display=swap" rel="stylesheet">
    <!--    구글 폰트 끝    -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"
            integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <link rel='stylesheet' href="/css/comment.css"/>
    <style>
        /*body {*/
        /*    font-family: Arial, sans-serif;*/
        /*    display: flex;*/
        /*    justify-content: center;*/
        /*    align-items: center;*/
        /*    height: 100vh;*/
        /*    margin: 0;*/
        /*}*/

        .content {
            display: flex;
            width: 50%;
            margin-top: 60px;
        }

        .sidebar {
            padding: 20px;
            margin: 2vh;
            background-color: #f2f2f2;
            min-width: 200px;
        }

        .box {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .h2 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .board-list, .search-ranking {
            list-style: none;
            padding: 0;
            margin: 0; /* remove default margin for ul/ol */
        }

        .board-list li, .search-ranking li {
            margin-bottom: 10px;
            cursor: pointer;
        }

        .board-list li:last-child, .search-ranking li:last-child {
            margin-bottom: 0;
        }

        .main-content {
            margin-left: 20px;
            margin-top: 5%;
            position: relative;
            top: 10%;
            left: 50%;
        }

        .post-header {
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .post-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .post-info {
            font-size: 14px;
            color: #777;
        }

        .post-image {
            max-width: 100%;
            margin-bottom: 20px;
        }

        .post-contents {
            font-size: 16px;
            line-height: 1.5;
        }

        .post-actions {
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
        }

        .action-button {
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            cursor: pointer;
            margin-left: 10px;
        }
        /* 상단바 */
        #header {
            background-color: #3f3d6c;
            color: #fff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;

            /* 상단바 고정 */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 100;
        }

        #room-info {
            display: flex;
            flex-direction: column;
        }

        #room-name {
            font-size: 1.5rem;
            margin: 0;
        }

        .footer {
            color: grey;
            text-align: center;
            border-top: 1px solid black;
            width: 100%;
            padding-bottom: 10px;
            margin-top: 30px;
            background-color: #242428;
        }

        .footer > p {
            font-family: 'Gugi', cursive;
            font-size: 30px;
            margin-top: 50px;
        }

        .footer > div {
            margin: auto;
        }
    </style>
</head>
<body>
<div id="header">
    <div id="room-info">
        <h2 id="room-name">상단바<span class="badge badge-info badge-pill"></span></h2>
    </div>
</div>
<div class="content">
    <div class="sidebar">
        <div class="box">
            <h2 class="h2">인기검색어</h2>
            <ol class="search-ranking">
                <!--                <li>검색어 1</li>-->
                <p></p>
            </ol>
        </div>
        <div>
            <ul class="board-list">
                <li><a href="/view/mainpage">전체게시판</a></li>
                <!-- 백엔드에서 가져온 게시판 목록을 순회하면서 출력 -->
                <th:block th:each="board : ${boardList}">
                    <li><a th:href="@{/view/boards/{boardId}(boardId=${board.id})}" th:text="${board.title}">게시판</a></li>
                </th:block>
            </ul>
        </div>
    </div>
    <div class="main-content">
        <div class="post-header">
            <h1 class="post-title" th:text="${post.title}">게시글 제목</h1>
            <div class="post-info">
                <span th:text="'작성자: ' + ${post.nickname}"></span>
                <span id="createdAt"></span>
                <span id="modifiedAt"> | 수정일: </span>
                <span th:text="' | 조회수: ' + ${post.viewCount} + ' | 좋아요: ' + ${post.likeCnt}"></span>
            </div>
        </div>
        <br/>
        <img class="post-image" id="post-image" th:src="${post.postImageUrl}" alt="게시글 이미지">
        <div class="post-contents">
            <p th:text="${post.contents}">
                게시글 내용이 여기에 들어갑니다.
            </p>
        </div>
        <br/>
        <div class="post-actions">
            <button class="action-button" id="likeButton">좋아요</button>
            <button class="action-button" id="unlikeButton">좋아요 취소</button>
            <button class="action-button" id="editButton">수정</button>
            <button class="action-button" id="deleteButton">삭제</button>
        </div>
    </div>
</div>
<!---start-comments-section--->
<div class="comment-section" style="padding:30px;">
    <div class="grids_of_2">
        <div class="grids_of_2" id="comments">
        </div>
        <div class="artical-commentbox">
            <hr style="border-top: 1px solid #6c757d;">
            <h2 class="comment-h2" style="font-family: 'Jua', sans-serif">댓글<span class="comment-h5" style="font-size: 20px"></span></h2>
            <div class="table-form">
                <form name="post_comment" style="position: relative">
                    <div>
                        <label style="font-family: 'Jua', sans-serif;">닉네임<span>*</span></label>
                        <h4 id="loginUserName"></h4>
                    </div>
                    <div>
                        <label for="userComment" style="font-family: 'Jua', sans-serif;">댓글창<span>*</span></label>
                        <button id="show" type="button">😀</button>
                        <textarea type="text" id="userComment" name="content" placeholder="내용을 입력해주세요."></textarea>
                    </div>
                    <div class="background">
                        <div class="window">
                            <div class="popup">
                                <button id="close" type="button">✖️️</button>
                                <div id="imglist" style="padding-left: 5px">
                                    <img id="airplane" src="/img/free-sticker-airplane-7496612.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="birthday" src="/img/free-sticker-birthday-boy-7379346.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="cauliflower" src="/img/free-sticker-cauliflower-7598101.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="coffee" src="/img/free-sticker-coffee-shop-7182801.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="confused" src="/img/free-sticker-confused-6684479.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="couple" src="/img/free-sticker-couple-7173075.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="eggplant" src="/img/free-sticker-eggplant-7598097.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="hate" src="/img/free-sticker-hate-7598095.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="hate2" src="/img/free-sticker-hate-7598096.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="heartbeat" src="/img/free-sticker-heartbeat-7173072.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="inspiration" src="/img/free-sticker-inspiration-6684493.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="lazy" src="/img/free-sticker-lazy-7470569.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="patient" src="/img/free-sticker-patient-7268641.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="pet" src="/img/free-sticker-play-with-pet-7260274.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="pet2" src="/img/free-sticker-play-with-pet-7260277.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="read" src="/img/free-sticker-read-7182833.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="sad" src="/img/free-sticker-sad-7598102.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="stay" src="/img/free-sticker-stay-at-home-7546335.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="stir" src="/img/free-sticker-stir-fry-7554151.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="worker" src="/img/free-sticker-worker-7546325.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                </div>
                            </div>
                            <div>
                            </div>
                        </div>
                    </div>

                    <div class="edit-background">
                        <div class="window">
                            <div class="editpopup">
                                <button id="editclose" type="button" onclick="editpopupclose()">✖️️</button>
                                <div id="editimglist" style="padding-left: 5px">
                                    <img id="editairplane" src="/img/free-sticker-airplane-7496612.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editbirthday" src="/img/free-sticker-birthday-boy-7379346.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editcauliflower" src="/img/free-sticker-cauliflower-7598101.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editcoffee" src="/img/free-sticker-coffee-shop-7182801.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editconfused" src="/img/free-sticker-confused-6684479.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editcouple" src="/img/free-sticker-couple-7173075.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editeggplant" src="/img/free-sticker-eggplant-7598097.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="edithate" src="/img/free-sticker-hate-7598095.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="edithate2" src="/img/free-sticker-hate-7598096.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editheartbeat" src="/img/free-sticker-heartbeat-7173072.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editinspiration" src="/img/free-sticker-inspiration-6684493.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editlazy" src="/img/free-sticker-lazy-7470569.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editpatient" src="/img/free-sticker-patient-7268641.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editpet" src="/img/free-sticker-play-with-pet-7260274.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editpet2" src="/img/free-sticker-play-with-pet-7260277.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editread" src="/img/free-sticker-read-7182833.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editsad" src="/img/free-sticker-sad-7598102.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editstay" src="/img/free-sticker-stay-at-home-7546335.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editstir" src="/img/free-sticker-stir-fry-7554151.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editworker" src="/img/free-sticker-worker-7546325.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                </div>
                            </div>
                            <div>
                            </div>
                        </div>
                    </div>

                    <div class="reply-background">
                        <div class="window">
                            <div class="replypopup">
                                <button id="replyclose" type="button" onclick="replypopupclose()">✖️️</button>
                                <div id="replyimglist" style="padding-left: 5px">
                                    <img id="replyairplane" src="/img/free-sticker-airplane-7496612.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replybirthday" src="/img/free-sticker-birthday-boy-7379346.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replycauliflower" src="/img/free-sticker-cauliflower-7598101.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replycoffee" src="/img/free-sticker-coffee-shop-7182801.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replyconfused" src="/img/free-sticker-confused-6684479.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replycouple" src="/img/free-sticker-couple-7173075.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replyeggplant" src="/img/free-sticker-eggplant-7598097.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replyhate" src="/img/free-sticker-hate-7598095.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replyhate2" src="/img/free-sticker-hate-7598096.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replyheartbeat" src="/img/free-sticker-heartbeat-7173072.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replyinspiration" src="/img/free-sticker-inspiration-6684493.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replylazy" src="/img/free-sticker-lazy-7470569.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replypatient" src="/img/free-sticker-patient-7268641.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replypet" src="/img/free-sticker-play-with-pet-7260274.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replypet2" src="/img/free-sticker-play-with-pet-7260277.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replyread" src="/img/free-sticker-read-7182833.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replysad" src="/img/free-sticker-sad-7598102.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replystay" src="/img/free-sticker-stay-at-home-7546335.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replystir" src="/img/free-sticker-stir-fry-7554151.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="replyworker" src="/img/free-sticker-worker-7546325.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                </div>
                            </div>
                            <div>
                            </div>
                        </div>
                    </div>

                    <div class="editreply-background">
                        <div class="window">
                            <div class="editreplypopup">
                                <button id="editreplyclose" type="button" onclick="editreplypopupclose()">✖️️</button>
                                <div id="editreplyimglist" style="padding-left: 5px">
                                    <img id="editreplyairplane" src="/img/free-sticker-airplane-7496612.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplybirthday" src="/img/free-sticker-birthday-boy-7379346.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplycauliflower" src="/img/free-sticker-cauliflower-7598101.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplycoffee" src="/img/free-sticker-coffee-shop-7182801.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplyconfused" src="/img/free-sticker-confused-6684479.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplycouple" src="/img/free-sticker-couple-7173075.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplyeggplant" src="/img/free-sticker-eggplant-7598097.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplyhate" src="/img/free-sticker-hate-7598095.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplyhate2" src="/img/free-sticker-hate-7598096.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplyheartbeat" src="/img/free-sticker-heartbeat-7173072.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplyinspiration" src="/img/free-sticker-inspiration-6684493.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplylazy" src="/img/free-sticker-lazy-7470569.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplypatient" src="/img/free-sticker-patient-7268641.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplypet" src="/img/free-sticker-play-with-pet-7260274.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplypet2" src="/img/free-sticker-play-with-pet-7260277.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplyread" src="/img/free-sticker-read-7182833.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplysad" src="/img/free-sticker-sad-7598102.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplystay" src="/img/free-sticker-stay-at-home-7546335.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplystir" src="/img/free-sticker-stir-fry-7554151.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                    <img id="editreplyworker" src="/img/free-sticker-worker-7546325.png"
                                         style="height: 100px; width: 100px; cursor: pointer">
                                </div>
                            </div>
                            <div>
                            </div>
                        </div>
                    </div>
                </form>
                <button id="createComments" class="btn btn-secondary" type="button">댓글 작성</button>
            </div>
            <div class="clear" id="comment"></div>
        </div>
    </div>
</div>
<nav aria-label="...">
    <ul class="pagination justify-content-center">
        <li class="page-item">
            <a href="#comment" class="page-link prev-page-button" style="cursor: pointer" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
        <li class="page-item page-numbers">
            <a href="#comment" class="page-link page-button active pagenumber"></a>
        </li>
        <li class="page-item">
            <a href="#comment" class="page-link next-page-button" style="cursor: pointer" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
    </ul>
</nav>
<br/>
<div id="eventLoading" class="ui active dimmer" style="position: fixed; display: none;">
    <div class="ui massive text loader">Loading</div>
</div>
<footer>
    <div class="footer">
        <p><img src="/img/tomato_logo.png" style="width: 50px;">우리 동네 커뮤니티 토마토</p>
        <br/>
        <div>
            <p>김휘수 | 모성민 | 손민지 | 주인수</p>
            <p>© 2023 7PRINCESS TOMATO ALL RIGHTS RESERVED</p>
        </div>
        <br/>
    </div>
</footer>
</body>
<script src="/js/comments.js"></script>
<script th:inline="javascript">
    const createdAt = [[${post.createdAt}]];
    const modifiedAt = [[${post.modifiedAt}]];

    let date = new Date(createdAt);

    const createdAtformattedDate = date.toLocaleString("ko-KR", {
        year: "numeric",
        month: "2-digit",
        day: "2-digit",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
    });

    $('#createdAt').text(` | 작성일: ${createdAtformattedDate}`)

    date = new Date(modifiedAt)

    const modifiedAtformattedDate = date.toLocaleString("ko-KR", {
        year: "numeric",
        month: "2-digit",
        day: "2-digit",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
    });

    $('#modifiedAt').text(` | 마지막수정일: ${modifiedAtformattedDate}`)

    $(document).ready(function() {
        if (!$('#post-image').attr('src')) {
            $('.post-image').hide();
        }

        // 인기검색어 데이터 가져와서 렌더링
        function renderPopularSearches(data) {
            var searchRanking = $(".search-ranking");
            searchRanking.empty();

            $.each(data, function(index, popularSearch) {
                var listItem = $("<li>").text(popularSearch.keyword);
                listItem.on("click", function() {
                    var keyword = encodeURIComponent(popularSearch.keyword);
                    var searchType = "titleAndContents";
                    window.location.href = "/view/searchKeyword?searchType=" + searchType + "&keyword=" + keyword;
                });
                searchRanking.append(listItem);
            });
        }

        // 백엔드 API 호출하여 인기검색어 데이터 가져오기
        $.ajax({
            url: "/api/popular-searches",
            method: "GET",
            success: function(data) {
                renderPopularSearches(data);
            },
            error: function() {
                console.error("Error fetching popular searches data.");
            }
        });

        var token = Cookies.get('Authorization');
        console.log(token);

        var urlParts = window.location.pathname.split("/");
        var postId = urlParts[urlParts.length - 1];

        function handleLike(postId) {
            $.ajax({
                url: "/api/posts/" + postId + "/likes",
                method: "POST",
                dataType: "json",
                headers: {
                    'Authorization': token,
                },
                success: function(response) {
                    if (response.status === 201 || response.status === 200) {
                        alert("게시물을 좋아요 했습니다!");
                        window.location.reload();
                    } else {
                        alert("좋아요 처리에 실패했습니다.");
                        window.location.reload();
                    }
                },
                error: function(response) {
                    if (response.status === 400) {
                        alert("이미 좋아요를 누른 게시물 입니다.");
                    } else {
                        alert("서버에서 오류가 발생했습니다.");
                    }
                }
            });
        }

        // 좋아요 버튼 클릭 이벤트 처리
        $("#likeButton").click(function() {
            handleLike(postId);
        });

        $("#unlikeButton").click(function() {
            handleUnlike(postId);
        });

// 좋아요 취소 요청을 서버에 보내는 함수
        function handleUnlike(postId) {
            $.ajax({
                url: "/api/posts/" + postId + "/likes",
                method: "DELETE",
                dataType: "json",
                headers: {
                    'Authorization': token, // 토큰주입 임시방편
                },
                success: function(response) {
                    if (response.status === 201 || response.status === 200) {
                        alert("게시물 좋아요를 취소했습니다!");
                        window.location.reload();
                    } else {
                        alert("좋아요 취소 처리에 실패했습니다.");
                        window.location.reload();
                    }
                },
                error: function(response) {
                    if (response.status === 400) {
                        alert("아직 좋아요를 누르지 않은 게시물 입니다.");
                    } else {
                        alert("서버에서 오류가 발생했습니다.");
                    }
                }
            });
        }

        $("#deleteButton").click(function() {
            handleDelete(postId);
        });

        function handleDelete(postId) {
            if (confirm("게시물을 삭제하시겠습니까?")) {
                // 게시물 삭제 요청을 서버에 보냅니다.
                $.ajax({
                    url: "/api/posts/" + postId, // postId에 실제 게시물 ID를 할당하세요.
                    method: "DELETE",
                    dataType: "json",
                    headers: {
                        'Authorization': token,
                    },
                    success: function (response) {
                        if (response.status === 200) {
                            alert("게시물이 성공적으로 삭제되었습니다.");
                            window.location.href = "/view/mainpage"; // 삭제 후 홈페이지로 이동하거나 필요한 페이지로 리다이렉션합니다.
                        } else {
                            alert("작성자만 삭제 가능합니다.");
                        }
                    },
                    error: function (response) {
                        if (response.status === 400) {
                            alert("작성자만 삭제 가능합니다.");
                        } else {
                            alert("서버에서 오류가 발생했습니다.");
                        }
                    }
                });
            }
        }

        $("#editButton").click(function() {
            handleEdit(postId);
        });

        function handleEdit(postId) {
            // 게시글 수정 페이지로 이동합니다.
            window.location.href = "/view/editpost/" + postId; // 적절한 URL로 수정 페이지 경로를 지정하세요.
        }

        /**
         * 게시글 좋아요 조회후 좋아요를 누른 아이디일 경우 좋아요 버튼 없앰
         * 아니면 좋아요 취소 버튼을 없애줌
         */
        $.ajax({
            url: `/api/posts/${postId}/likes`,
            method: "GET",
            success: function(data) {
                const payload = JSON.parse(atob(token.split(".")[1]));
                const usernames = payload.sub;

                for (const result of data.result) {
                    if (result.username === usernames && result.likes === true) {
                        $('#likeButton').hide();
                    }
                }

                if ($('#likeButton').css('display') !== 'none') {
                    $('#unlikeButton').hide();
                }
            },
            error: function() {
                console.log("좋아요 조회 오류");
            }
        })

    });
</script>
</html>